<!-- templates/components/header/inference_form.html -->

<!-- Root wrapper controls overlay positioning -->
<div class="relative">

    <div class="bg-white rounded-[2.5rem] shadow-2xl shadow-blue-900/10 border border-slate-200">
        <div class="p-6 sm:p-10 space-y-8">

            <form
                hx-post="/predict-ui"
                hx-target="#result-area"
                hx-indicator="#inference-loader"
                class="space-y-6"
            >

                <div class="space-y-4">
                    <div class="px-1 space-y-1">
                        <label for="text" class="block text-[10px] font-black uppercase tracking-[0.3em] text-slate-400 text-center">
                            Natural Language Stream
                        </label>
                        
                        <p class="text-[9px] font-bold uppercase tracking-wider text-slate-300 text-center">
                            Rapid Presets
                        </p>
                    </div>

                    <div class="flex flex-wrap gap-2 justify-center">
                        {% for preset in [
                            {"label": "Pure Joy", "text": "This engineering is top tier! ğŸ˜ğŸš€"},
                            {"label": "Frustration", "text": "The service was extremely slow today... ğŸ˜’"},
                            {"label": "Sarcasm/Mixed", "text": "I love waiting in long lines. :-) ğŸ˜­"},
                            
                        ] %}
                        <button 
                            type="button"
                            onclick="document.getElementById('text').value = '{{ preset.text }}'; document.getElementById('text').focus();"
                            class="px-3 py-1.5 rounded-full bg-slate-100 border border-slate-200 
                                text-[11px] font-bold text-slate-600 hover:bg-blue-500 
                                hover:text-white hover:border-blue-500 transition-all active:scale-95"
                        >
                            {{ preset.label }}
                        </button>
                        {% endfor %}
                    </div>

                    <div class="relative z-20"> 
                        
                        <textarea
                            name="text"
                            id="text"
                            rows="3"
                            onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); this.form.requestSubmit(); }"
                            class="w-full px-6 py-5 bg-slate-50 border-2 border-slate-100 rounded-2xl
                                focus:border-blue-500 focus:bg-white outline-none transition-all
                                text-xl sm:text-2xl placeholder-slate-300 resize-none font-medium shadow-inner pr-16"
                            placeholder="Analyze the vibe... âœ¨"
                            required
                        ></textarea>

                        <button
                            type="button"
                            onclick="toggleEmojiPicker()"
                            class="absolute bottom-4 right-4 w-10 h-10
                                   flex items-center justify-center
                                   rounded-xl bg-white border border-slate-200
                                   hover:border-blue-400 hover:text-blue-500
                                   transition-all shadow-sm z-10"
                        >
                            âœ¨
                        </button>

                        <div
                            id="emoji-picker"
                            class="hidden absolute top-full right-0 mt-2
                                bg-white border border-slate-200 shadow-2xl
                                rounded-3xl p-5 w-72 sm:w-80
                                z-50 animate-in fade-in slide-in-from-top-2"
                        >
                            <div class="flex items-center justify-between mb-4 px-1">
                                <h3 class="text-[10px] font-black uppercase tracking-widest text-slate-400">
                                    Signal Library
                                </h3>
                                <div class="flex gap-2">
                                    <span class="px-2 py-0.5 rounded-full bg-blue-50 text-blue-600 text-[9px] font-bold uppercase">Hybrid Set</span>
                                </div>
                            </div>

                            <div class="max-h-64 overflow-y-auto pr-2 custom-scrollbar">
                                
                                <div class="mb-4">
                                    <p class="text-[9px] font-bold text-slate-300 uppercase mb-2 px-1">Positive Signals</p>
                                    <div class="grid grid-cols-5 gap-2">
                                        {% for emoji in [
                                            "ğŸ˜‚","ğŸ¤£","ğŸ˜Š","ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜","ğŸ˜‰","ğŸ˜„","ğŸ˜†",
                                            "ğŸ˜€","ğŸ˜›","ğŸ¥³","ğŸ˜‡","ğŸ˜‹","ğŸ˜","ğŸ˜Œ","ğŸ‘","ğŸ™Œ","ğŸ‘",
                                            "ğŸ‘Œ","ğŸ’ª","ğŸ”¥","âœ¨","ğŸŒŸ","ğŸ’¯","âœ…","â¤ï¸","ğŸ’–","ğŸš€"
                                        ] %}
                                        <button type="button" onclick="insertEmoji('{{ emoji }}')"
                                                class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-blue-50 hover:scale-110 transition-all text-xl">
                                            {{ emoji }}
                                        </button>
                                        {% endfor %}
                                    </div>
                                </div>

                                <div>
                                    <p class="text-[9px] font-bold text-slate-300 uppercase mb-2 px-1">Negative Signals</p>
                                    <div class="grid grid-cols-5 gap-2">
                                        {% for emoji in [
                                            "ğŸ˜­","ğŸ˜’","ğŸ˜”","ğŸ˜¢","ğŸ˜","ğŸ˜Ÿ","ğŸ˜ ","ğŸ˜¡","ğŸ¤¬","ğŸ¤¯",
                                            "ğŸ˜©","ğŸ˜«","ğŸ˜¤","ğŸ˜°","ğŸ˜¨","ğŸ˜±","ğŸ˜§","ğŸ˜²","ğŸ™„","ğŸ¤¨",
                                            "ğŸ’”","ğŸ‘","âŒ","ğŸ›‘","âš ï¸","ğŸ’€","ğŸ¤¡","ğŸ¤®","ğŸ’©","ğŸ“‰"
                                        ] %}
                                        <button type="button" onclick="insertEmoji('{{ emoji }}')"
                                                class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-red-50 hover:scale-110 transition-all text-xl">
                                            {{ emoji }}
                                        </button>
                                        {% endfor %}
                                    </div>
                                </div>

                            </div>
                        </div>

                        <style>
                            /* Custom scrollbar for a cleaner look */
                            .custom-scrollbar::-webkit-scrollbar { width: 4px; }
                            .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                            .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
                            .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
                        </style>
                        </div>
                </div>

                <button
                    type="submit"
                    class="w-full bg-slate-900 hover:bg-blue-700 text-white font-bold py-5
                           rounded-2xl transition-all shadow-lg active:scale-[0.98]
                           flex items-center justify-center gap-3"
                >
                    <span class="tracking-wide text-sm uppercase">
                        Execute Classification
                    </span>
                </button>

            </form>

            <div id="result-area" class="relative min-h-[140px] border-t border-slate-50 flex">

                <div class="flex flex-col items-center justify-center w-full text-center group-[.htmx-request]:hidden">
                    <div class="space-y-4 opacity-40">
                        <div class="flex justify-center gap-1.5">
                            <span class="w-1.5 h-1.5 rounded-full bg-slate-400 animate-[bounce_2s_infinite_0ms]"></span>
                            <span class="w-1.5 h-1.5 rounded-full bg-slate-400 animate-[bounce_2s_infinite_200ms]"></span>
                            <span class="w-1.5 h-1.5 rounded-full bg-slate-400 animate-[bounce_2s_infinite_400ms]"></span>
                        </div>
                        
                        <p class="text-[10px] font-mono uppercase tracking-[0.3em] animate-pulse">
                            Ready for Stream
                        </p>
                    </div>
                </div>
                
                <div id="inference-loader" class="htmx-indicator absolute inset-0 flex flex-col items-center justify-center text-blue-600">
                    <div class="animate-spin h-10 w-10 border-[4px] border-blue-600 border-t-transparent rounded-full"></div>
                </div>
            </div>

        </div>
    </div>
</div>